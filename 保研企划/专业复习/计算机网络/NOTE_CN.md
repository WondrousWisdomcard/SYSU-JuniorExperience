包烟复习 计算机网络

[toc]

# 第一章：计算机网络与因特网

## 1.1 什么是因特网

### 1.1.1 具体构成描述

**主机**（host）又称为端系统（end system），通过**通信链路**（communication link）和**分组交换机**（packet switch）连接在一起。通信链路由不同类型的物理媒介组成（有线和无线），包括电缆，铜线，光纤，无线电频谱等。分组交换机从一条入通信链路接受到达的分组，并从一条出通信链路转发该分组，种类有路由器（router）和链路层交换机（link-layer switch）等。

其中，**分组**（packet）是端系统向另一端系统发送数据时将数据分段，并为每段加上首部字节而形成的信息包。从发送端系统到接收端系统，一个分组经历的通信链路和分组交换机成为通过该网络的路径。（route或path）。

### 1.1.3 什么是协议

**一个协议定义了在两个或者多个通信实体之间交换的报文格式和次序，以及报文传输或接收所采取的行动。**

## 1.2 网络边缘

位于网络的边缘，因特网的端系统包括桌面计算机，服务器和移动计算机等。端系统又称为主机，**主机又分为客户机（client）和服务器（server）。**

## 1.3 网络核心

### 1.3.1 电路交换和分组交换

电路交换和分组交换是通过网络链路和交换机移动数据的两种基本方法。在电路交换网络中，沿着端系统通信路径，为端系统之间通信所提供的资源（**缓存，链路传输速率**等）会在通信会话期被**预留**，而在分组交换网络中则不会，使数据传输在分布交换网络可能需要**排队**。因特网是分组交换网络的典范。

### 1.3.2 分组是怎样通过分组交换网形成通路的

**路由器**使用分组的目的地址来索引**转发表**，向相邻的路由器转发该分组，一步一步找到合适的链路。因特网具有一些特殊的选路协议，它们用于自动地设置转发表。(不使用地图而喜欢问路)

## 1.5 协议层次与它们的服务模型

### 1.5.1 分层的结构体系

分层提供了一种结构化的方式来讨论系统组件。

各层的所有协议被称为协议栈，因特网的协议栈由：**物理层、链路层、网络层、运输层和应用层**。

1. 应用层：网络应用程序及其应用协议存留的地方，常见协议有HTTP、SMTP、FTP。应用层协议分布在多个端系统上，一个端系统中的应用程序使用协议与另一个端系统中的应用程序交换分组信息。我们将这种位于应用层的信息分组称为报文。

2. 运输层：提供了在应用程序端点之间传送应用层报文的服务。两个运输层协议分别是TCP和UDP。TCP提供了**面向连接**的服务，并提供拥塞控制机制和流量控制；UDP提供**面向无连接**的服务，不提供可靠性保障。我们将运输层分组成为报文段。

3. 网络层：负责将数据报datagram的网络层分组从一台主机移动到另一台主机上。IP协议定义了数据报中的各个字段以及端系统和路由器如何做用于这些字段。因特网的网络层也包括决定路由的选路协议。

4. 链路层：在每一个节点，网络层将数据下传给链路层，链路层沿着路径将数据报传递给下一个节点，在下一个节点，链路层再将数据报上传给网络层。我们将链路层分组成为帧frame。

5. 物理层：物理层的任务是将帧的一个一个比特从一个节点移动到下一个节点。

6. ISO模型：国际标准化组织ISO在上个世纪七十年代提出了七层的开放系统互联模型OSI。OSI参考模型的七层是：**应用、表示、会话**、传输、网络、链路、物理。表示层的作用是使通信的应用程序能够解释交换数据的含义，提供数据压缩，数据加密，数据描述等功能；会话层提供了数据交换的定界和同步功能。

# 第二章 应用层

## 2.1 应用层协议原理

研发网络应用程序的核心是**写出能够运行在不同端系统和通过网络彼此通信的程序**。而网络核心设备（路由器、链路交换机）在应用层不起作用。

### 2.1.1 网络应用程序体系结构

应用程序体系结构（**区别于网络的体系结构**）由应用程序研发者设计，规定了如何在各种端系统上组织该应用程序。**现代网络中应用程序所使用的两种主流的体系结构分别是客户机/服务器模型和对等体系结构（P2P)**

#### 客户机/服务器模型

1. **客户机/服务器体系结构中，有一个总是打开的作主机称为服务器，服务于来自许多其他的称为客户机的主机的请求。** Web、FTP、Telnet（远程终端协议，实现远程登录）和电子邮件采用的就是典型的客户机/服务器模型。
2. 客户机/服务器模型的一个重要特征是服务器具有固定的，周知的地址，称为IP地址。所以客户机总是能够通过该地址向服务器发送分组请求以与其联系。

#### P2P体系结构

1. 在这种体系结构下对基础设施服务器有着最小的依赖。任意连接的主机对直接相互通信。

### 2.1.2 进程通信

不同端系统的进程通过跨越计算机网络交换报文而相互通信。发送进程创建并向网络中发送报文，接收进程接受这些报文并可能负责回送报文。进程通过一个叫套接字（Socket）的软件接口在网络上发送和接收报文。

### 2.1.3 可供应用程序使用的运输服务

**选择合适的传输层协议，考虑因素主要包括：可靠数据传输，吞吐量，定时和安全性。**

### 2.1.5 应用层协议

**应用层协议定义了运行在不同端系统上的应用程序进程如何相互传递报文**。定义了：交换的报文的类型、报文类型的语法，如各个字段及其详细描述、字段的语义，即包含在字段中信息的含义、进程何时、如何发送报文以及对报文的相应规则

## 2.2 Web和HTTP协议

### 2.2.1 HTTP概况

HTTP全名**超文本传输协议**，是Web的核心。HTTP协议由客户机程序和服务器程序两部分实现，他们运行在不同的端系统中，通过交换HTTP报文进行会话。**HTTP协议使用TCP作为他的支撑运输层协议**。

### 2.2.3 HTTP报文格式

两种格式：请求报文和响应报文

### 2.2.5 Web缓存

52. Web缓存也叫代理服务器（proxy server），它是能够代表初始Web服务器来满足HTTP请求的网络实体。它有自己的储存空间，已保存最近请求过的对象的拷贝。它既是服务器，又是客户机。

53. 浏览器请求网页的过程：

    1. 浏览器建立一个到Web缓存器的TCP连接，向Web缓存器中的对象发送一个HTTP请求。
    2. Web缓存器检查是否有本地拷贝，有则用HTTP响应报文向客户机返回该对象
    3. 没有则向初始服务器（请求网页的服务器）打开一个TCP连接，并向其发送HTTP请求，初始服务器响应。
    4. Web接受该对象后，在本地储存一份拷贝，并用HTTP响应报文发给浏览器该对象的拷贝。

## 2.3 文件传输协议:FTP

56. **FTP使用两个并行的*TCP*链接来传输文件**，一个是控制连接，一个是数据连接，前者用于在两个主机之间传输控制信息，后者用于传输实际文件。
57. FTP会话创建

    1. 客户机在21号端口上发起一个用于控制的TCP连接，并通过该控制连接发送用户口令和标识等命令
    2. 服务器接收文件传输命令后，发起一个到客户机的数据连接（客户机20端口）。
    3. 控制连接贯穿对话全过程，但是每一次传输文件都要单独建立一个数据连接。


## 2.4 因特网中的电子邮件

60. 电子邮件系统的组成：用户代理，邮件服务器，简单邮件传输协议（SMTP）
61. SMTP使用TCP可靠传输服务，从发送方的邮件服务器向接收方的邮件服务器发送邮件。每个邮件服务器有两个部分：SMTP服务器和SMTP用户机

### 2.4.1 SMTP

62. SMTP邮件收发过程：
    1. A调用A的邮件代理程序并提供B的邮件地址写邮件，让后通过用户代理发送邮件
    2. A的用户代理将报文发送给A的邮件服务器，将报文放在报文发送队列中
    3. 运行在A邮件服务器的SMTP客户极端将创建一个到B的邮件服务器的SMTP服务器的TCP链接
    4. 经过初始SMTP握手之后，B的接收服务器接收该报文，再将邮件放入B的邮箱中。
    5. B方便时调用用户代理阅读邮件。

### 2.4.4 邮件访问协议

67. B从邮件服务器上拉取邮件，使用的不是SMTP（推协议），而是专门的邮件访问协议，例如POP3（第三版的邮局协议）、IMAP（因特网邮件访问协议）和HTTP。

## 2.5 DNS：因特网的目录服务

### 2.5.1 DNS提供的服务

73. 识别主机的两种方式：主机名和IP地址，前者用以记忆，后者定长、有层次结构
74. 域名解析系统 DNS：进行主机名到IP地址转换的服务。**DNS是一个由分层DNS服务器实现的分布式数据库，也是一个允许主机查询分布式数据库的应用层协议**，**DNS运行在UDP之上**，使用53号端口。

### 2.5.2 DNS工作原理

78. **递归查询和迭代查询**

    * **主机向本地域名服务器的查询一般都是采用递归查询。**所谓递归查询就是：如果主机所询问的本地域名服务器不知道被查询的域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其它根域名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。
    * **本地域名服务器向根域名服务器的查询的迭代查询。**迭代查询的特点：当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地服务器：你下一步应当向哪一个域名服务器进行查询。


# 第三章 传输层

## 3.1 概述和运输层服务

0. 运输层协议**为运行在不同主机上的应用进程提供逻辑通信服务**，在端系统中实现

## 3.2 多路复用与多路分解

1. 多路复用和多路分解是将网络层所提供的**主机到主机交付服务**扩展到为在主机上运行的应用程序所提供的**进程到进程的交付服务**。**传输层负责将这些报文段中的数据交付给主机上运行的合适的应用进程**。
2. 套接字：享受网络服务的进程有一个到多个套接字（唯一标识），相当于网络向进程和进程向网络传递数据的门户。接收主机中的运输层实际上并没有将数据直接交付给进程，而是通过一个中间的套接字来传递。
3. **多路分解**：传输层检查报文段中的特定字段并标识出接收套接字，然后将报文段定向到该套接字；**将传输层报文段中的数据交付到正确的套接字的工作**。
4. **多路复用**：**从源主机的不同套接字中收集数据块，并为每个数据块封装上首部信息从而生成报文段，然后将报文段传递到网络层的工作**。
5. 源端口号字段和目的端口号字段：端口号是16比特的，范围从**0~65535**之间，0~1023称为周知端口号
6. 一个**UDP套接字是由一个包含目的IP和目的端口号的二元组来全面标识的**；而**TCP套接字是通过一个四元组（源IP、源端口号、目的IP、目的端口号）来标识的**，与UDP不同的是，两个不同源IP地址或源端口号的到达的TCP报文段将会被定向到两个不同的套接字，除非TCP携带了初始创建连接的请求。

## 3.3 无连接传输：UDP

1. 除了多路复用、多路分解和一些轻型的差错检测外，UDP几乎没有对IP增加别的东西。

2. 选用UDP的部分原因：应用层能更好地控制要发送的数据和发送时间、无需建立连接、无需维护连接状态、分组首部开销小。

## 3.4 可靠数据传输的原理

### 3.4.1 构造可靠数据传输协议

4. 非流水线下：可靠传输协议是一个**停等协议**，即一个包传输成功后，下一个包才能开始传输，引入的协议要点：**检验和、序号、定时器、肯定确认**（冗余ACK），能够解决比特差错和丢包。

### 3.4.2 流水线可靠数据传输协议

5. **解决流水线的差错恢复**的两种基本方法：**回退N步和选择重传**，使用的机制总结：检验和、定时器、序号、累计确认、**窗口**和流水线。

### 3.4.3 回退N步（Go-Back-N，GBN）

6. 窗口：N为窗口长度，那些**已经被发送但还未被确认的许可序号范围**可以看成是一个在序号范围内长度为N的窗口，GBN又称滑动窗口协议，窗口内包含**待确认的分许序号**（**从”基序号“到“下一个序号“**）和可以**被立即发送的分组序号**（**从”下一个序号“到”基序号+N-1“**）。

### 3.4.4 选择重传（SR）

10. 选择重传协议通过让发送方仅重传那些**它怀疑**出错的分组，同样使用窗口来限制流水线中未完成、未被确认的分组，在SR下，**发送方的窗口中已确认的可以不是连续的。发送方的窗口和接受方的窗口并不总是一致的。**

## 3.5 面向连接的运输：TCP

### 3.5.4 可靠数据传输

8. 累计确认、缓存失序分组、加倍超时间隔、快速重传（三个冗余ACK）


### 3.5.5 流量控制

10. TCP提供流量控制服务**以消除发送方使得接收方缓存溢出的可能**

### 3.5.6 TCP连接管理

13. 建立TCP连接：三次握手
    1. 客户机向服务器的TCP发送一个特殊的TCP报文段（TCP SYN），发送给服务器。
    2. 一旦报文段到达服务器主机，服务器为该TCP连接分配TCP缓存和变量，并向客户端发送允许链接的报文段（SYNACK）。
    3. 客户机收到SYNACK报文段后，客户机给连接分配缓存和变量，还会向服务器发送另外一个报文段。

## 3.7 TCP拥塞控制

1. 拥塞窗口：TCP拥塞机制让链接的每一个端都记录一个额外的变量，即**拥塞窗口**(Congestion Window)，CongWin，**用于限制一个发送方向网络发送是流量的速率**，并满足一个发送方中未确认的数据量不超过CongWin和RcvWindow。暂时忽略RcvWindow，当丢包事件发生后（三个冗余ACK），则暗示出现了拥塞。

三个TCP拥塞控制算法：

1. AIMD **加性增，乘性减** ：**丢包事件发生后，让CongWin减半**，以MSS为单位，单次发送不得少于一个MSS。**不丢包则缓慢增加拥塞窗口的长度**（每次增加一个MSS）。
2. SS 慢启动：当一个TCP连接开始时，CongWin的初始值设置为1个MSS，即初始传输速率为MSS/RTT， **每过一个RTT将CongWin翻倍，直到发生一个丢包事件，降到一半并从此线性增长。**
3. 对超时时间作出反应：发生超时时，TCP发送方进入一个慢启动阶段，CongWin被置为1，开始成倍增加。

# 第四章 网络层

## 4.1 概述

1. **网络层**：实现主机到主机的通信服务。
2. **数据报**：网络层分组的称呼。

### 4.1.1 转发与选路

3. **转发**：当一个分组到达某**路由器**的一条输入链路时，该路由器必须将该分组移动到适当的输出链路。

4. **选路**：当分组从发送方流向接收方时，网络层必须决定这些分组所采用的路由或路径，计算这些路径的算法称为选路算法。
5. **转发表**，一台路由器有一个转发表。路由器通过检查分组信息来作为转发表的索引查出报文对应的输出链路。

### 4.1.2 网络服务模型

7. IP：**尽力而为服务、定时、顺序、最终交付不保证**。

8. ATM 网络体系结构（网络层）


## 4.2 虚电路和数据报网络

### 4.2.1 虚电路网路

12. 因特网是数据报网络，ATM、帧中继是虚电路网络。
13. **一条虚电路的组成**：源与目的主机之间的路径、VC号（沿着该路径的每段链路的一个号码）、沿路径每台路由器的转发表。当跨越一台路由器创建一条新的虚电路时，转发表就增加一个新项。

### 4.2.2 数据报网络

16. 数据报网络传输过程：随着分组向目的地传输，它通过一系列路由器，路由器根据目的地址，将其映射到链路接口的转发表转发分组。一般转发表由选路算法维护
17. **最长前缀匹配原则**：在该表中寻找最长的匹配项，并向与最长前缀匹配的链路接口转发该分组。

## 4.3 路由器工作原理

18. 路由器的四个组成部分：输入端口、交换结构、输出结构、选路处理器

## 4.4 网际协议：因特网中的转发和编址

27. 因特玩的网络层三个主要的组件：
    * IP协议（编址规则、数据报格式、分组处理规则）
    * 选路协议（路径选择、RIP/OSPF/BGP）
    * ICMP协议（差错报告、路由器指令）

### 4.4.2 IPv4编址

31. **一个IP地址在技术上时与一个接口相关联的**，而不是与主机或路由器相关联。一个IP地址的组成部分需要由其连接的子网来决定。一个例子：223.1.1.0/24 子网IP，/24指子网掩码，任何其他要连到该网段的主机都要求IP地址为223.1.1.xxx
32. **子网**：为了确定子网，分开主机和路由器的每个接口，从而产生几个分离的网络岛，接口段接了独立的网络端点，这些每一个独立的网络称作子网。
33. 无类别域间选路 CIDR： IP地址被划分为两部分，并具有个数a.b.c.d/x，其中x指示地址在第一部分中的比特数，第一部分构成**IP地址的网络部分**，又被称为该地址的前缀，而剩下的**第二部分用于区分组织内部设备**的。
34. 分类编址：**限制IP网络长度为8、16、24，分别称为A、B、C**类网络。
35. IP广播地址:255.255.255.255，向他发送数据报时，该报文会被**交付给同一个子网中的所有主机**。
36. 获取IP地址的三种方法：从ISP（因特网服务提供商）那获取、DHCP（动态主机配置协议）获取、NAT（网络地址转换协议）获取

### 4.4.3 ICMP协议（互联网控制报文协议）

41. **ICMP用于主机和路由器彼此交互网络信息**，典型用于差错报告，例如返回“目的网络不可达”等错误报文。**ICMP报文是承载在IP分组中的，本质上是一个上层协议。**

### 4.4.4 IPv6

46. IPv6引入的变化 ：（部分）
    1. 扩大的地址容量：从32位加到**128位**。
    2. 简单高效40字节首部，舍弃许多IPv4字段。

## 4.5 选路算法

52. **默认路由器：与一台主机直接相连的路由器**，也称为第一跳路由器，源路由器和目的路由器分别指的是源主机和目的主机的默认路由器。
53. 选路算法分类：
    * 全局和分布：
      * **全局选路算法**（通过网络全貌计算最低费用路径，以所有节点之间的连通性和链路费用为输入，如LS算法）
      * **分布式选路算法**（以迭代、分布式的方式计算最优路径，没有节点拥有网络链路费用的完整信息，而**每个节点仅有与其直接连接的链路费用即开始计算**，在计算过程中节点交换信息，逐渐所处最优路径，如DV算法）

### 4.5.1 链路状态选择算法 LS

54. 链路状态选择算法LS：网络拓扑中所有的链路费用都是已知的，可用作算法的输入，其中每个链路状态分组包含他所连接的链路的特征和费用。
55. Dijkstra：全局选路算法，算出从源节点到网络每一个节点的最短路径，复杂度$O(n^2)$。

### 4.5.2 距离量选路算法 DV

57. 距离向量算法是一种迭代的异步的分布式的算法

    * 分布式：每个节点都要从一个或者多个直接相连的邻居接受某些信息，执行计算再将计算结果返回给邻居。
    * 迭代：此过程需要一直持续到邻居之间没有更多信息可以交换为止
    * **异步：它不要求所有节点之间步伐一致地操作**

## 4.6 因特网中的选路

### 4.6.1 因特网中的AS内部选路：RIP

64. 选路信息协议 RIP：是一种**距离向量协议**，并定义了**跳数**作为费用测度，每天链路费用为1，最大跳数被限制在15。RIP通过RIP响应报文（RIP通告）进行邻居间的选路信息交换，交换周期为30秒。**RIP是一个运行在UDP之上的应用层协议。**

### 4.6.2 因特网中AS内部选路：OSPF

65. 开放最短路径优先协议 OSPF：核心是一个使用洪泛链路状态信息的链路状态协议和一个Dijkstra最低费用路径算法。每个使用OSPF的路由器本地运行Dijkstra，以确定网络的最短路径树，链路费用由管理员设置


### 4.6.3 自治系统间的选路：BGP

67. **BGP 边界网关协议**
    

## 4.7 广播和多播选路

69. 广播选路和多播选路：
    * Broadcast 广播选路：网络层提供从一个源节点到网络中所有其他节点交付分组的任务
    * Multicast 多播选路：网络层提供从一个源节点到网络中所有其他网络节点的一个子集交付分组的任务

### 4.7.1 广播选路算法

70. 无控制**洪泛**：要求源节点向它的所有邻居发送该分组的拷贝，当某个节点接收到一个广播分组时，复制该份发往该节点的其他邻居。缺点是若该网络有环路，会导致分组拷贝无休止地循环（**广播风暴**）
71. 受控洪泛：**序号控制洪泛**、**反向路径转发**、**生成树广播**

# 第五章 链路层和局域网

## 5.1 链路层：概述和服务

### 5.1.1 链路层提供的服务

1. 链路层基本概念：链路层协议用来在独立的链路上移动数据报，它定义了在链路端点两端的节点之间交互的分组格式，以及当发送和接受这些分组时这些节点所采用的动作。

2. 链路层的数据单元：帧。当发送和接受帧时，链路层协议所采取的动作包括差错检测、重传、流量控制和随机接入。

3. 链路层协议：**以太网、802.11无线LAN、令牌环和PPP**，很多场合下ATM也被视为链路层协议。
4. 链路层的任务：将上层数据包通过路径中的**单端链路节点到节点地传送**，因此，在不同的路径上可能由不同的链路层协议所承载，并且不同协议提供的服务可能是不同的。
5. **链路层能够提供的服务：成帧、链路接入、可靠交付、流量控制、差错检测、差错纠正、半双工和全双工**（采用全双工传输时，链路两端的节点可以同时传输分组，半双工指一个结点不能同时进行传输和接收）
6. 链路层提供的一些服务（可靠交付、流量控制、差错检测）于网络层所提供的这些服务的不同之处：传输层是在端到端的基础上提供的，而**链路层协议是在节点对相邻节点的基础上提供的**。 
7. 两种类型的网络链路：点对点链路和广播链路，点对点链路是由链路一端的当个发送方和链路另一端的单个接收方组成，例如点对点协议PPP和高级数据链路控制HDLC。**广播链路能够让多个发送和接收节点都连接到相同的、单一的、共享的广播信道上**，例如以太网和无线LAN。

### 5.1.2 链路层在何处实现

8. **链路层的主体部分是在*网络适配器*中实现**的，网络适配器也称为网络接口卡。链路层的控制器的许多功能都是用硬件实现的，现在网络适配器都已经被综合进了主机的主板

## 5.3 多路访问协议

10. 多路访问问题：**如何协调多个发送和接收节点对一个共享广播信道的访问。**
11. 多路访问协议：**节点通过这些协议来规范它们在共享的广播信道上的传输行为**。

### 5.3.1 信道划分协议

13. 三种用于共享信道节点之间用于划分广播信道宽带的技术：时分多路复用（TDM）、频分多路复用（FDM）、码分多址（CDMA）。

### 5.3.2 随机接入协议

17. 在**随机接入协议**中，一个传输节点总是以信道的全部速率进行发送，当有碰撞时，涉及碰撞的每个节点反复地重发它的帧，直到该帧无碰撞地通过为止。但是当一个节点经受一次碰撞时，他不必立刻重发该帧，相反，它在重发该帧之前等待一个随机时延。
18. 常用的随机接入协议：ALOHA协议和CSMA协议（载波侦听多路协议），然后，**以太网是CSMA协议**。
21. 载波侦听多路访问（CSMA）
    * 载波侦听：Carrier sensing，**在一个节点传输前先听信道，若有别的节点正在发送，则等待一段随机事件。**
    * 碰撞检测：Collision detection，**在一个节点在传输时一直在侦听信道，若检测到另一个节点的干扰就停止传输。**

### 5.3.4 局域网

24. 局域网：**一种集中在一个地理区域的计算机网络**，LAN包括基于随机接入的以太网和令牌传递技术中。

## 5.4 链路层编制

### 5.4.1 MAC地址

26. **MAC地址**：我们将链路层地址称为MAC地址，节点的适配器所具有的链路层地址，**MAC地址长度为6字节（48比特）**，六个字节通常用16进制表示法表示，没有两个适配器拥有相同的MAC地址。
27. 当某适配器要向目的适配器发送帧时，发送方将目的适配器的MAC地址插入到该帧中，发送到LAN。若该LAN是一个广播LAN，则该帧会被发送到其他所有适配器，接收方对帧进行检查，若目的MAC与本机一致则提取出封装的数据，否则丢弃该数据报。对于目的地址为所有人，目的MAC地址则填MAC广播地址（FF-FF-FF-FF-FF-FF）

### 5.4.2 地址解析协议 ARP

28. 目的：**在网络层地址和链路层地址之间进行转换**。
29. ARP解析器与DNS解析器的差别：DNS为在因特网中的任何地方的主机解析主机名，而**ARP只为在同一个子网上的节点解析IP地址**。
31. ARP工作原理：每个节点在ARP模块维护一个ARP表，此表包含**IP地址到MAC地址的映射关系**。


## 5.5 以太网

33. **以太网是一种有线局域网**。
34. 以太网设备：集线器、**交换机**（反映了以太网的发展历程，从总线型到基于集线器的星型结构，到基于交换机的星型结构）。

### 5.5.1 以太网帧结构

35. 基带传输：**以太网采用基带传输**，许多以太网技术采用曼彻斯特编码（物理层操作），使用原因是发送和接受的适配器之间没有精确的同步。
36. 服务类型：**以太网向网络层提供不可靠的无连接服务。**

### 5.5.2 CSMA/CD: 以太网多路访问协议

38. CSMA/CD机制：**无时隙、载波侦听、碰撞检测、随机重传**。
39. CSMA/CD下适配器要求：当某些其他适配器在传输时进行侦听；当传输时检测碰撞。以太网适配器通过测量传输前和传输中的**电压水平**来执行这两个任务。

## 5.6 链路层交换机

43. 交换机的任务：**接收入链路层帧并将它们转发到出链路**，交换机输出接口设有缓存。

### 5.6.1 交换机的转发和过滤

44. **过滤：交换机决定一个帧是应该转发到某个接口还是应当将其丢弃。**
45. **转发：决定一个帧应该被导向哪个接口，并把该帧接口移动到这些接口的交换机功能。**
46. 交换机表：交换机的过滤和转发都需要依靠交换机表完成，该表包含LAN上某些节点但不必是全部节点的表项，一个表项包含：节点MAC地址、到达该节点的交换机接口，该项放置在该表中的时间。

### 5.6.4 交换机与路由器的比较

51. 直接差别：**路由器使用网络层IP地址转发，链路层交换机使用链路层MAC地址转发分组**，本质上它们都是储存转发分组交换机。

# 第六章 无线网络与移动网络

## 6.1 概述

1. 无线链路：主机可以通过无线通讯链路连接到一个基站或另一台无线主机，两个主要特性为：**覆盖区域和链路速率**。
2. 基站：无线网络基础设施的一个关键部分，没有明确的对应设备，**它负责向与之关联的无线主机发送数据和接收数据**，通常用于协调多无线主机的传输。蜂窝塔和802.11中无线LAN的接入点都是基站。
3. 自组织网络：无线主机之间没有基站这样的基础设施链接，有则为基础设施模式网络。
4. 切换（Hand off）：一台移动主机移动范围超出一个基站的覆盖范围而到达另一个基站的覆盖范围之后，它将改变其接入更大网络的连接点。

## 6.3 Wifi:  802.11无线WLAN

10. IEEE 802.11无线LAN也称为Wifi（无线保真），**有802.11b、802.11a、802.11g几套标准**，它们在频率范围和数据率上限上有区分，但它们都使用**CSMA/CA**，都允许基础设施模式和自组织模式。

# 第八章 计算机网络中的安全

## 8.1 网络安全

1. 安全通信所具备的特性：
   1. 机密性（Confidentiality）：仅有发送方和其指定的接收方能够理解报文内容，要求报文在一定程度上进行加密（Encrypted）。
   2. 报文完整性（Message Integrity）：确保通信的内容在传输过程中没有被恶意篡改或意外改动
   3. 端点鉴别（End-point Authentication）：发送方与接收方都应能证实通信过程所涉及的另一方，以确信通信的另一方确实具有他们所声称的身份。
   4. 运行安全性（Operational Security）

### 8.2.1 对称密钥密码学

3. 对称加密技术两种类型：流密码和块密码。块密码应用于PGP、SSL、IPsec等加密协议中。
4. 块密码：将要加密的报文处理为一块块固定比特的块，块密码通常使用函数模拟随机派列表。流行的块密码包括**DES、3DES、AES**。

### 8.2.2 公开密钥加密

7. 公开密钥加密的用途：加密、鉴别和数字签名。
8. 基本思路：公钥（KB+）为所有人可知，私钥(KB-)只有发送者知道。在通讯前，A先取得B的公钥，然后用着一个公钥和一个众所周知的加密算法，加密A要传给B的报文（即A计算KB+(m)），B收到该报文后计算KB-(KB+(m))  = m获得加密报文（然而不同于对称密钥：KB+(KB+(m))  不等于 m）。

9. **会话密钥**：RSA通常与对称密钥结合在一起使用，因为RSA很耗时。如果A要向B发送大量数据，首先A选择一个用于加密的数据本身的密钥，这个密钥又称为会话密钥K_s，A通过RSA加密该会话密钥，计算$c = (K_s)^e mod n$，B收到后解密，解密后用改会话密钥进行数据传输。

## 8.3 报文完整性

13. 数据完整性也称为报文鉴别，包括数字签名和端点鉴别。**报文鉴别包含以下两点内容：1）报文来源正确、2）报文未被篡改**

### 8.3.1 密码散列函数

14. **密码散列函数**在哈希的基础上，要求找到任意两个内容不同的但哈希相同的报文，在计算上是不可能的。
15. 两个目前广泛使用散列算法：
    1. **MD5**散列算法：得到128比特的散列
    2. **SHA-1**散列算法：生成160比特的报文摘要

### 8.3.2 报文鉴别码

16. 鉴别密钥（Authentication Key）：**由发送方和接受方共享的比特串。**

### 8.3.3 数字签名

18. 数字签名（Digtial Signature），需满足签名是可证实的，并且改签名无法被伪造。
19. 数字签名的操作过程：B让初始长度的报文通过一个散列函数，然后用私钥对散列进行数字签名。**明文形式的初始报文连同已经数字签名的报文摘要一并发送给A。A将公钥应用于数字签名获得散列结果，然后再把散列函数应用于明文报文已得到第二个散列结果，二者进行比较。**


## 8.4 端点鉴别

25. 端点鉴别（End-point Authentication）：**一个实体经过计算机网络向另一个实体证明其身份的过程**。鉴别协议（Authentication Protocol）**通常在两个通讯实体运行其他协议之前完成**。 
26. **不重数**（Nonce）：一个生存协议中只使用一次的数，用于**抵御报文回放攻击**。

## 8.9 运行安全性：防火墙和入侵检测系统

### 8.9.1 防火墙

34. **防火墙是一种软件和硬件的结合，将内部网络与因特网隔开，只允许一些数据分组通过。**







**2、根据自己的理解，给出以下术语的定义：a）计算机网络；b）互联网；c）网络协议；d） 资源子网和通信子网。** 

* 计算机网络：一个通过通信线路连接具有独立功能的分散计算机设备以实现**信息传递和资源共享**的系统。
* 互联网：指以一组通用的协议相连形成的网络与网络之间所串连成的庞大网络。
* 网络协议: 一个协议定义了在两个或者多个通信实体之间交换的报文格式和次序以及报文传输或接收所采取的行动。
* 资源子网和通信子网：**资源子网指指用户端系统**，由计算机系统、终端、终端控制器、连网外设、各种软件资源与信息资源组成；**通信子网指网络中实现网络通信功能的设备及其软件的集合**，由网卡、线缆、集线器、中继器、网桥、路由器、交换机等设备和相关软件组成。



**1、 中山大学校园网的用户用浏览器访问网页：www.qq.com，请详细论述访问过程涉及到的应用层协议操作，包括 DNS、HTTP 和 Proxy 等。**

**具体访问过程：**

1. **DNS域名解析过程**：浏览器抽取出目标网页地址的主机名（这里就指 www.qq.com）提出查询请求，以获取网页地址的 IP。

   1. 查询**浏览器的 DNS 缓存**，若存在该网页地址的 IP 映射，则返回对应的 IP 地址，否则进入下一步骤。

   2. 查询**本地计算机的DNS 缓存**，若存在该网页地址的 IP 映射，则返回对应的 IP 地址，否则进入下一步骤。

   3. 查询**hosts 文件**，若存在该网页地址的 IP 映射，则返回对应的 IP 地址，否则进入下一步骤。

      >hosts 文件：一个记录常用网址域名与其对应的 IP 地址的文件，在我的电脑中的位置：C:\Windows\System32\drivers\etc\hosts 。

   4. 查询**路由器的 DNS 缓存**，若存在该网页地址的 IP 映射，则返回对应的 IP 地址，否则进入下一步骤。

   5. 向**本地DNS服务器**（LDNS）发出请求。本地DNS服务器收到查询时：

      1. 若目的网页地址的 IP 映射包含在本地配置区域资源中，则返回解析结果给客户机；

      2. 若该 IP 映射不包含在本地配置区域资源中，但该服务器缓存已经缓存了目的网页地址的 IP 映射，也则返回解析结果给客户机；

      3. 否则进入下一步骤。

      > 该服务器提供本地互联网接入的一个DNS解析服务，由于用户使用的是校园网，这个本地区的域名服务器是在中山大学内。

   6. 本地 DNS 服务器以 DNS 客户的身份向根域名服务器继续发送查询请求报文，此过程采用迭代查询。

      1. 首先，本地 DNS 服务器**向根 DNS 服务器发送请求**，根 DNS 服务器收到请求后，判断这个域名(.com)对应的顶级域名服务器，并返回该顶级域名服务器的一个IP 给本地 DNS 服务器。
      2. 然后，本地 DNS 服务器收到顶级域名服务器的 IP 信息后，**向顶级域名服务器发送请求**。顶级域名服务器收到请求后，若能解析 IP 地址，则直接将 IP 返回给本地 DNS 服务器；若无法解析，则返回 .com域的下一级 DNS 服务器地址（www.qq.com）给本地 DNS 服务器。
      3. 最后，本地 DNS 服务器获得 www.qq.com 的 IP地址（实际上，该主机名有很多服务器 IP ，其中我连接上了一个 IPv6 格式的地址 ```2402:4e00:1020:1404:0:9227:71a3:83d2```，它的别名是```ins-r23tsuuf.ias.tencent-cloud.net```），并将解析结果返回给客户机；

   >  前五步的查询过程采用递归查询，在每一级返回时会更新上一级的DNS缓存，以便于下一次访问。

   >  第六步查询过程采用的是迭代查询，实际上，即便本地 DNS 服务器的缓存中不存在 www.qq.com 的 IP 地址，也可能储存着顶级域名服务器 .com 的 IP 地址，在迭代过程中，可以省略向根服务器查询顶级域名服务器 IP 地址的过程。

2. **使用 HTTP 获取 Web页面**：浏览器接收来自于 DNS 的 IP 地址后，通过该 IP 地址定位的 HTTP 服务器发起一个 HTTP请求，过程中涉及代理服务器（Web缓存器）的使用。

   1. 浏览器首先建立一个到中山大学的 Web 缓存器（Proxy）的TCP连接，并向 Web 缓存器中的对象发送一个 HTTP 请求报文，报文的方法字段为```GET```。

      > Web缓存器又称为代理服务器，在这个例子中，用户所连接的 Web 缓存器由中山大学提供，所有校园网的用户浏览器都指向它。

   2. Web 缓存器检查本地是否储存了该对象的拷贝，若有且没有过期，则直接使用 HTTP 响应报文 向客户机返回 www.qq.com 的 Web 网页；若没有或已经过期了，则进入下一步。

   3. Web缓存器就对该对象的初始服务器 www.qq.com 建立一个 TCP 连接，连接成功后，发送一个获取 Web 网页对象的 HTTP 请求报文。

   4. 服务器在收到请求报文后，将对应的 Web 页面的文件封装在一个 HTTP 响应报文中，并通过套接字向 Web 缓存器发送响应报文。

   5. Web 缓存器接收到该响应报文后，在本地储存空间中储存一份 www.qq.com 的 Web 网页对象的拷贝，并通过 客户机浏览器与 Web 缓存器的TCP连接，用 HTTP 响应报文向客户机的浏览器发送该拷贝。

   6. 客户机浏览器接收 Web 缓存器的响应报文，关闭 TCP 连接，并从响应报文中提取出 HTML 文件，并显示在浏览器上。







