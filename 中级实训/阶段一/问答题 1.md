# Stage 1 - 回答问题 1

**19335286 郑有为**

1. 问题：Does the bug always move to a new location? Explain.
   
   * 回答：并不会，一个Bug只能移动到相邻的一个合法的位置，并且这个格子为空或含Flower。
     
     * 获取一个相邻位置，并判断位置是否合法（存在）
       
       ```java
       // @file: info/gridworld/actor/Bug.java
       // @line: 98-99
       if (!gr.isValid(next))
           return false;
       ```
     * 判断格子是否为空或含Flower
       
       ```java
       // @file: info/gridworld/actor/Bug.java
       // @line: 101
       return (neighbor == null) || (neighbor instanceof Flower);
       ```
2. 问题：In which direction does the bug move?
   
   * 回答： Bug移动的方向由Bug继承自基类Actor的属性`direction`决定，其值为度数
     
     ```java
     // @file: info/gridworld/actor/Bug.java
     // @line: 97
     Location next = loc.getAdjacentLocation(getDirection());
     ```
3. 问题：What does the bug do if it does not move?
   
   * 回答：转向寻找可以移动的位置（向右转动45度）。
     
     ```java
     // @file: info/gridworld/actor/Bug.java
     // @line: 53-56
     if (canMove())
         move();
     else
         turn();
     
     // @file: info/gridworld/actor/Bug.java
     // @line: 64
     setDirection(getDirection() + Location.HALF_RIGHT);
     ```
4. 问题：What does a bug leave behind when it moves?
   
   * 回答：一朵和Bug的颜色相同的Flower
     
     ```java
     // @file: info/gridworld/actor/Bug.java
     // @line: 82-83
     Flower flower = new Flower(getColor());
     flower.putSelfInGrid(gr, loc);
     ```
5. 问题：What happens when the bug is at an edge of the grid? (Consider whether the bug is facing the edge as well as whether the bug is facing some other direction when answering this question.)
   
   * 回答：如果直面边界或以45度或135度指向边界（意味着它的下一步预计移动位置越界），Bug会转向（向右转向45度，直至方向不再指向相邻的边界），否则Bug保持移动方向继续移动。
     
     ```java
     // @file: info/gridworld/grid/BoundedGrid.java
     // @line: 60-64
     public boolean isValid(Location loc)
     {
         return 0 <= loc.getRow() && loc.getRow() < getNumRows()
             && 0 <= loc.getCol() && loc.getCol() < getNumCols();
     }
     
     // @file: info/gridworld/actor/Bug.java
     // @line: 98-99
     if (!gr.isValid(next))
         return false;
     
     // @file: info/gridworld/actor/Bug.java
     // @line: 53-56
     if (canMove())
         move();
     else
         turn();
     ```
6. 问题：What happens when a bug has a rock in the location immediately in front of it?
   
   * 回答：不能按照此方向向前移动（canMove() == false），转向
     
     ```java
     // @file: info/gridworld/actor/Bug.java
     // @line: 53-56
     if (canMove())
         move();
     else
         turn();
     
     // @file: info/gridworld/actor/Bug.java
     // @line: 98-99
     Actor neighbor = gr.get(next);
     return (neighbor == null) || (neighbor instanceof Flower);
     ```
7. 问题：Does a flower move?
   
   * 回答：Flower不会在Step或Run时移动，但使用者可以通过`moveTo`方法来移动它
     
     ```java
     // @file: info/gridworld/actor/Actor.java
     // @line: 173-174
     location = newLocation;
     grid.put(location, this);
     ```
8. 问题：What behavior does a flower have?
   
   * 回答：
     
     * 首先，Flower类继承自Actor类，Actor类赋予Flower：设置颜色、设置位置、添加进网格、从网格中移动或移除这些基本行为；
       
       ```java
       // @file: info/gridworld/actor/Actor.java
       // @line: 60
       public void setColor(Color newColor)
       // @line: 80
       public void setDirection(int newDirection)
       // @line: 115 
       public void putSelfInGrid(Grid<Actor> gr, Location loc);
       // @line: 133
       public void removeSelfFromGrid();
       // @line: 155
       public void moveTo(Location newLocation);
       ```
     * 同时Flower还具有颜色变暗这个行为。
       
       ```java
       // @file: info/gridworld/actor/Flower.java
       // @line: 54-62
       public void act()
       {
           Color c = getColor();
           int red = (int) (c.getRed() * (1 - DARKENING_FACTOR));
           int green = (int) (c.getGreen() * (1 - DARKENING_FACTOR));
           int blue = (int) (c.getBlue() * (1 - DARKENING_FACTOR));
       
           setColor(new Color(red, green, blue));
       }
       ```
9. 问题：Does a rock move or have any other behavior?
   
   * 回答：
     
     * 和Flower一样，Rock不会自己移动，但是用户可以调用`moveTo`使其移动到另一个位置。
       
       ```java
       // @file: info/gridworld/actor/Actor.java
       // @line: 173-174
       location = newLocation;
       grid.put(location, this);
       ```
     * Rock继承自Actor，和Flower一样，继承了Actor的行为，但没有其他额外行为。
       
       ```java
       // @file: info/gridworld/actor/Rock.java
       // @line: 54-56
       public void act()
       {
       }
       ```
10. 问题：Can more than one actor (bug, flower, rock) be in the same location in the grid at the same time?
    
    * 回答：可以，可以点击空格右键创建Bug、Flower或Rock。
      
      ```java
      // @file: info/gridworld/grid/BoundedGrid.java
      // @line: 102-104
      E oldOccupant = get(loc);
      occupantArray[loc.getRow()][loc.getCol()] = obj;
      return oldOccupant;
      ```
      
      ![file](/api/users/image?path=8506/images/1634794910114.png)

---